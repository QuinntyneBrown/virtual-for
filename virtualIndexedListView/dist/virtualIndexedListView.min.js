angular.module("virtualIndexedListView",["rx"]);var VirtualIndexedListView;!function(e){var t=function(){function e(e,t){var i=this;this.getHtml=e,this.virtualIndexedListViewRenderer=t,this.restirct="A",this.transclude="element",this.scope=!1,this.compile=function(e){function t(e){e[0].removeAttribute("virtual-indexed-list-view"),e[0].removeAttribute("virtual-indexed-list-view-collection-name"),e[0].removeAttribute("virtual-indexed-list-view-item-name"),e[0].removeAttribute("virtual-indexed-list-view-item-height"),e[0].removeAttribute("virtual-indexed-list-view-items")}var n=i.virtualIndexedListViewRenderer,r=e.parent(),o=i.getHtml;return function(e,i,l,d,a){a(e.$new(),function(i){t(i),n.createInstance({element:angular.element(r),template:o(i[0],!0),scope:e,items:l.virtualIndexedListViewItems?JSON.parse(l.virtualIndexedListViewItems):e[l.virtualIndexedListViewCollectionName],itemName:l.virtualIndexedListViewItemName,itemHeight:l.virtualIndexedListViewItemHeight}).render()})}}}return e.createInstance=function(t,i){return new e(t,i)},e}();e.VirtualIndexedListView=t,angular.module("virtualIndexedListView").directive("virtualIndexedListView",["virtualIndexedListView.getHtml","virtualIndexedListViewRenderer",t.createInstance])}(VirtualIndexedListView||(VirtualIndexedListView={}));var VirtualIndexedListView;!function(e){"use strict";!function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.None=2]="None"}(e.ScrollingDirection||(e.ScrollingDirection={}));e.ScrollingDirection}(VirtualIndexedListView||(VirtualIndexedListView={}));var VirtualIndexedListView;!function(e){"use strict";var t=function(e,t){if(!e||!e.tagName)return"";var i,n,r=document.createElement("div");return r.appendChild(e.cloneNode(!1)),i=r.innerHTML,t&&(n=i.indexOf(">")+1,i=i.substring(0,n)+e.innerHTML+i.substring(n)),r=null,i};angular.module("virtualIndexedListView").value("virtualIndexedListView.getHtml",t)}(VirtualIndexedListView||(VirtualIndexedListView={}));var VirtualIndexedListView;!function(e){"use strict";var t=function(e){for(var t=[],i=0;i<e.renderedNodes.length;i++){var n=e.getY(e.renderedNodes[i]),r=e.renderedNodes[i].offsetTop,o=e.itemHeight;t.push({top:n+r,bottom:n+r+o,index:angular.element(e.renderedNodes[i]).scope().$$index,node:e.renderedNodes[i]})}return e.desc?t.sort(function(e,t){return t.top-e.top}):t.sort(function(e,t){return e.top-t.top}),t};angular.module("virtualIndexedListView").value("virtualIndexedListView.getRenderedNodesComputedInfo",t)}(VirtualIndexedListView||(VirtualIndexedListView={}));var VirtualIndexedListView;!function(e){"use strict";var t=function(t,i){return i&&t>i?e.ScrollingDirection.Down:i&&i>t?e.ScrollingDirection.Up:i&&t===i?e.ScrollingDirection.None:null};angular.module("virtualIndexedListView").value("virtualIndexedListView.getScrollDirection",t)}(VirtualIndexedListView||(VirtualIndexedListView={}));var VirtualIndexedListView;!function(e){e.getY=function(e){var t=angular.element(e).css("transform");return"none"===t?0:JSON.parse(t.replace(/^\w+\(/,"[").replace(/\)$/,"]"))[5]},angular.module("virtualIndexedListView").value("virtualIndexedListView.getY",e.getY)}(VirtualIndexedListView||(VirtualIndexedListView={}));var VirtualIndexedListView;!function(e){e.transformY=function(e,t){return angular.element(e).css({"-moz-transform":"translateY("+t+"px)","-webkit-transform":"translateY("+t+"px)","-ms-transform":"translateY("+t+"px)","-transform":"translateY("+t+"px)"}),e},angular.module("virtualIndexedListView").value("virtualIndexedListView.transformY",e.transformY)}(VirtualIndexedListView||(VirtualIndexedListView={}));var VirtualIndexedListView;!function(e){var t=function(){function e(t){var i=this;this.$window=t,this.createInstance=function(t){var n=new e(i.$window);return n.scrollableParentElement=n.getScrollableParent(t.element[0]),n},this.getScrollableParent=function(e){if("HTML"==e.tagName)return null;var t=angular.element(e).css("overflowY");return"scroll"==t||"auto"==t?angular.element(e):e.parentNode?i.getScrollableParent(e.parentNode):void 0}}return Object.defineProperty(e.prototype,"scrollY",{get:function(){return this.scrollableParentElement?this.scrollableParentElement[0].scrollTop:this.$window.pageYOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scrollableParentElement?this.scrollableParentElement[0].offsetHeight:this.$window.innerHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.scrollY+this.height},enumerable:!0,configurable:!0}),e}();angular.module("virtualIndexedListView").service("virtualIndexedListView.viewPort",["$window",t])}(VirtualIndexedListView||(VirtualIndexedListView={}));var VirtualIndexedListView;!function(e){"use strict";var t=function(){function t(i,n,r,o,l,d,a,s,u){var c=this;this.$compile=i,this.$injector=n,this.$interval=r,this.$timeout=o,this.getRenderedNodesComputedInfo=l,this.getScrollDirection=d,this.getY=a,this.observeOnScope=s,this.transformY=u,this.createInstance=function(e){var i=new t(c.$compile,c.$injector,c.$interval,c.$timeout,c.getRenderedNodesComputedInfo,c.getScrollDirection,c.getY,c.observeOnScope,c.transformY);i.items=e.items,i.itemName=e.itemName,i.scope=e.scope,i.element=e.element,i.template=e.template,i.itemHeight=Number(e.itemHeight),i.viewPort=c.$injector.get("virtualIndexedListView.viewPort").createInstance({element:i.element}),i.numberOfRenderedItems>i.items.length&&(i.numberOfRenderedItems=i.items.length),i.$interval(function(){i.render({scrollY:i.viewPort.scrollY,lastScrollY:i.lastYScroll,viewPortHeight:i.viewPort.height}),i.lastYScroll=i.viewPort.scrollY},10,null,!1);var n=null;return i.observeOnScope(i.scope,"vm.filterTerm").map(function(e){return e}).subscribe(function(e){i.filterTerm.observedChange=e,i.filterTerm.newValue=e.newValue,i.filterTerm.oldValue=e.oldValue,i.filterFn=function(e){return e.name.indexOf(i.filterTerm.newValue)>-1},n&&i.$timeout.cancel(n),n=i.$timeout(function(){i.render({force:!0,lastScrollY:0,scrollY:0,viewPortHeight:i.viewPort.height})},10,!1)}),i.filterFn=i.scope.filterFn,i},this._filterTerm={},this.render=function(t){t||(t={lastScrollY:0,scrollY:0,viewPortHeight:c.viewPort.height});var i;if(t.force){for(var n=c.containerElement[0],r=0;r<n.children.length;r++){var o=angular.element(n.children[r]).scope();o.$destroy()}n.innerHTML="",angular.element(n).css("height",c.containerHeight);for(var r=0;r<c.numberOfRenderedItems;r++){var l=c.scope.$new(!0);l[c.itemName]=c.items[r],l.$$index=r;var d=c.$compile(angular.element(c.template))(l);angular.element(n).append(d)}try{c.scope.$digest()}catch(a){}c.hasRendered=!0}if(c.hasRendered===!1){i=angular.element("<div class='container'></div>"),i.css("height",c.containerHeight),c.element.append(i);for(var r=0;r<c.numberOfRenderedItems;r++){var l=c.scope.$new(!0);l[c.itemName]=c.items[r],l.$$index=r;var d=c.$compile(angular.element(c.template))(l);i.append(d)}try{c.scope.$digest()}catch(a){}}if(c.getScrollDirection(t.scrollY,t.lastScrollY)===e.ScrollingDirection.Down){var s=!1,u=!1,m=null,g=null;do{var f=c.getRenderedNodesComputedInfo({getY:c.getY,renderedNodes:c.renderedNodes,itemHeight:c.itemHeight,desc:!1});if(f[f.length-1].bottom>=c.containerBottom?s=!0:(g=f[f.length-1].index+1,m=c.items[g]),f[0].bottom>=t.scrollY&&(u=!0),!s&&!u){c.transformY(f[0].node,c.numberOfRenderedItems*c.itemHeight+c.getY(f[0].node));var h=angular.element(f[0].node).scope();h[c.itemName]=m,h.$$index=g,h.$digest()}}while(!s&&!u)}if(c.getScrollDirection(t.scrollY,t.lastScrollY)===e.ScrollingDirection.Up){var v=!1,u=!1,m=null,g=null;do{var f=c.getRenderedNodesComputedInfo({getY:c.getY,renderedNodes:c.renderedNodes,itemHeight:c.itemHeight,desc:!0});if(f[f.length-1].top<=0?v=!0:(g=f[f.length-1].index-1,m=c.items[g]),f[0].top<=t.scrollY+t.viewPortHeight&&(u=!0),!v&&!u){c.transformY(f[0].node,c.getY(f[0].node)-c.numberOfRenderedItems*c.itemHeight);var h=angular.element(f[0].node).scope();h[c.itemName]=m,h.$$index=g,h.$digest()}}while(!v&&!u)}if(c.hasRendered&&c.getScrollDirection(t.scrollY,t.lastScrollY)===e.ScrollingDirection.None){var f=c.getRenderedNodesComputedInfo({getY:c.getY,renderedNodes:c.renderedNodes,itemHeight:c.itemHeight,desc:!1}),p=f[0].top,w=f[f.length-1].bottom;if(p>t.scrollY&&console.log("missing items on top"),w<=t.scrollY+t.viewPortHeight){console.log("missing items on bottom");var s=!1,u=!1,m=null,g=null;do{var f=c.getRenderedNodesComputedInfo({getY:c.getY,renderedNodes:c.renderedNodes,itemHeight:c.itemHeight,desc:!1});if(f[f.length-1].bottom>=c.items.length*c.itemHeight?s=!0:(g=f[f.length-1].index+1,m=c.items[g]),f[0].bottom>=t.scrollY&&(u=!0),!s&&!u){c.transformY(f[0].node,c.numberOfRenderedItems*c.itemHeight+c.getY(f[0].node));var h=angular.element(f[0].node).scope();h[c.itemName]=m,h.$$index=g,h.$digest()}}while(!s&&!u)}}c.hasRendered=!0},this.hasRendered=!1,this.lastYScroll=0}return Object.defineProperty(t.prototype,"filterTerm",{get:function(){return this._filterTerm},set:function(e){this._filterTerm=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"containerHeight",{get:function(){return this.items.length*this.itemHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this.filterFn&&this.filterTerm.newValue?this._items.filter(this.filterFn):this._items},set:function(e){this._items=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numberOfRenderedItems",{get:function(){return this._numberOfRenderedItems?this._numberOfRenderedItems:Math.ceil(1380/Number(this.itemHeight))},set:function(e){this._numberOfRenderedItems=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"containerElement",{get:function(){return this._containerElement?this._containerElement:this.element.find(".container")},set:function(e){this._containerElement=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"containerBottom",{get:function(){return this.containerElement[0].offsetHeight+this.containerElement[0].offsetTop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"containerTop",{get:function(){return this.containerElement[0].offsetTop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderedNodes",{get:function(){return this.containerElement[0].children},enumerable:!0,configurable:!0}),t}();angular.module("virtualIndexedListView").service("virtualIndexedListViewRenderer",["$compile","$injector","$interval","$timeout","virtualIndexedListView.getRenderedNodesComputedInfo","virtualIndexedListView.getScrollDirection","virtualIndexedListView.getY","observeOnScope","virtualIndexedListView.transformY",t])}(VirtualIndexedListView||(VirtualIndexedListView={}));