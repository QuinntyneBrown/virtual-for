{"version":3,"sources":["services/filterableCollectionManager.ts"],"names":["VirtualIndexedListView","VirtualIndexedListView.FilterableCollectionManager","VirtualIndexedListView.FilterableCollectionManager.constructor","VirtualIndexedListView.FilterableCollectionManager.numberOfItems","VirtualIndexedListView.FilterableCollectionManager.items"],"mappings":"AAAA,yDAAyD;AACzD,mDAAmD;AAEnD,IAAO,sBAAsB,CA4J5B;AA5JD,WAAO,sBAAsB,EAAC,CAAC;IAE3BA;QACIC,qCAAoBA,EAAgBA,EAAUA,QAA4BA;YAD9EC,iBA8ECA;YA7EuBA,OAAEA,GAAFA,EAAEA,CAAcA;YAAUA,aAAQA,GAARA,QAAQA,CAAoBA;YAMnEA,mBAAcA,GAAGA,UAACA,OAAoDA;gBACzEA,IAAIA,QAAQA,GAAGA,IAAIA,2BAA2BA,CAACA,KAAIA,CAACA,EAAEA,EAACA,KAAIA,CAACA,QAAQA,CAACA,CAACA;gBACtEA,QAAQA,CAACA,KAAKA,GAAGA,OAAOA,CAACA,KAAKA,CAACA;gBAC/BA,QAAQA,CAACA,aAAaA,GAAGA,OAAOA,CAACA,KAAKA,CAACA,MAAMA,CAACA;gBAC9CA,QAAQA,CAACA,QAAQA,GAAGA,OAAOA,CAACA,KAAKA,CAACA,IAAIA,CAACA,CAACA,OAAOA,CAACA,gBAAgBA,CAACA,CAACA;gBAElEA,OAAOA,CAACA,KAAKA,CAACA,MAAMA,CAACA,OAAOA,CAACA,qBAAqBA,EAAEA,UAACA,UAAcA;oBAC/DA,QAAQA,CAACA,UAAUA,GAAGA,UAAUA,CAACA;oBACjCA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAGA,CAACA,EAAEA,CAACA,GAAGA,QAAQA,CAACA,aAAaA,CAACA,MAAMA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;wBACrDA,QAAQA,CAACA,aAAaA,CAACA,CAACA,CAACA,CAACA,QAAQA,EAAEA,CAACA;oBACzCA,CAACA;gBACLA,CAACA,CAACA,CAACA;gBACHA,MAAMA,CAACA,QAAQA,CAACA;YACpBA,CAACA,CAAAA;YAEMA,4BAAuBA,GAAGA,UAACA,OAAYA;gBAE1CA,IAAIA,QAAQA,GAAGA,KAAIA,CAACA,EAAEA,CAACA,KAAKA,EAAEA,CAACA;gBAE/BA,IAAIA,KAAKA,GAAGA,IAAIA,CAACA;gBAEjBA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAGA,CAACA,EAAEA,CAACA,GAAGA,KAAIA,CAACA,KAAKA,CAACA,MAAMA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;oBACzCA,EAAEA,CAACA,CAACA,KAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA,OAAOA,CAACA,QAAQA,CAACA,GAAGA,CAACA,IAAIA,OAAOA,CAACA,QAAQA,CAACA,KAAKA,CAACA,CAACA,CAACA;wBAChEA,KAAKA,GAAGA,CAACA,CAACA;oBACdA,CAACA;gBACLA,CAACA;gBAEDA,QAAQA,CAACA,OAAOA,CAACA,EAAEA,KAAKA,EAAEA,KAAKA,EAAEA,CAACA,CAACA;gBAEnCA,MAAMA,CAACA,QAAQA,CAACA,OAAOA,CAACA;YAC5BA,CAACA,CAAAA;YA+BMA,kBAAaA,GAAoBA,EAAEA,CAACA;YAEpCA,cAASA,GAAGA,UAACA,OAA0BA;gBAC1CA,KAAIA,CAACA,aAAaA,CAACA,IAAIA,CAACA;oBACpBA,QAAQA,EAAEA,OAAOA,CAACA,QAAQA;oBAC1BA,EAAEA,EAAEA,KAAIA,CAACA,aAAaA,CAACA,MAAMA,GAAGA,CAACA;oBACjCA,QAAQA,EAAEA,IAAIA;iBACjBA,CAACA,CAACA;gBACHA,MAAMA,CAACA,KAAIA,CAACA,aAAaA,CAACA,MAAMA,CAACA;YACrCA,CAACA,CAAAA;YA3EGA,IAAIA,CAACA,IAAIA,GAAGA,qCAAcA,CAACA,UAAUA,CAACA;QAC1CA,CAACA;QA0CDD,sBAAWA,sDAAaA;iBAAxBA;gBACIE,MAAMA,CAACA,IAAIA,CAACA,cAAcA,CAACA;YAC/BA,CAACA;iBAEDF,UAAyBA,KAAaA;gBAClCE,IAAIA,CAACA,cAAcA,GAAGA,KAAKA,CAACA;YAChCA,CAACA;;;WAJAF;QAQDA,sBAAWA,8CAAKA;iBAAhBA;gBAAAG,iBAOCA;gBANGA,EAAEA,CAACA,CAACA,IAAIA,CAACA,UAAUA,IAAIA,IAAIA,CAACA,UAAUA,IAAIA,EAAEA,CAACA,CAACA,CAACA;oBAC3CA,MAAMA,CAACA,IAAIA,CAACA,MAAMA,CAACA,MAAMA,CAACA,UAACA,IAASA;wBAChCA,MAAMA,CAACA,KAAIA,CAACA,QAAQA,CAACA,IAAIA,EAAEA,KAAIA,CAACA,UAAUA,CAACA,CAACA;oBAChDA,CAACA,CAACA,CAACA;gBACPA,CAACA;gBACDA,MAAMA,CAACA,IAAIA,CAACA,MAAMA,CAACA;YACvBA,CAACA;iBAEDH,UAAiBA,KAAYA;gBACzBG,IAAIA,CAACA,MAAMA,GAAGA,KAAKA,CAACA;YACxBA,CAACA;;;WAJAH;QAgBLA,kCAACA;IAADA,CA9EAD,AA8ECC,IAAAD;IACDA,6EAA6EA;IAC7EA,+GAA+GA;IAE/GA,yFAAyFA;IACzFA,qGAAqGA;IACrGA,yCAAyCA;IACzCA,wDAAwDA;IAExDA,oCAAoCA;IAEpCA,+EAA+EA;IAC/EA,oCAAoCA;IACpCA,8BAA8BA;IAC9BA,gBAAgBA;IAChBA,4CAA4CA;IAE5CA,uDAAuDA;IAEvDA,qCAAqCA;IACrCA,+DAA+DA;IAE/DA,4DAA4DA;IAC5DA,+EAA+EA;IAC/EA,+DAA+DA;IAC/DA,uBAAuBA;IACvBA,gCAAgCA;IAChCA,eAAeA;IACfA,aAAaA;IACbA,0BAA0BA;IAC1BA,OAAOA;IAEPA,0DAA0DA;IAE1DA,yCAAyCA;IAEzCA,iCAAiCA;IAEjCA,kCAAkCA;IAClCA,QAAQA;IAERA,wBAAwBA;IAExBA,qCAAqCA;IAErCA,kCAAkCA;IAClCA,qCAAqCA;IACrCA,OAAOA;IAEPA,+CAA+CA;IAC/CA,sCAAsCA;IACtCA,OAAOA;IAEPA,4BAA4BA;IAE5BA,0BAA0BA;IAC1BA,6BAA6BA;IAC7BA,OAAOA;IAEPA,sCAAsCA;IACtCA,8BAA8BA;IAC9BA,OAAOA;IAEPA,iDAAiDA;IAEjDA,0DAA0DA;IAC1DA,mCAAmCA;IACnCA,yCAAyCA;IACzCA,gDAAgDA;IAChDA,4BAA4BA;IAC5BA,aAAaA;IACbA,2CAA2CA;IAC3CA,OAAOA;IACPA,GAAGA;IAEHA,OAAOA,CAACA,MAAMA,CAACA,wBAAwBA,CAACA,CAACA,OAAOA,CAACA,oDAAoDA,EAAEA,CAACA,IAAIA,EAAEA,UAAUA,EAACA,2BAA2BA,CAACA,CAACA,CAACA;AAC3JA,CAACA,EA5JM,sBAAsB,KAAtB,sBAAsB,QA4J5B","file":"services/filterableCollectionManager.js","sourcesContent":["/// <reference path=\"../../typings/typescriptapp.d.ts\" />\r\n/// <reference path=\"../enums/collectiontype.ts\" />\r\n\r\nmodule VirtualIndexedListView {\r\n\r\n    class FilterableCollectionManager implements IFilterableCollectionManager {\r\n        constructor(private $q: ng.IQService, private $timeout: ng.ITimeoutService) {\r\n            this.type = collectionType.filterable;\r\n        }\r\n\r\n        public type: collectionType;\r\n\r\n        public createInstance = (options: IFilterableCollectionManagerInstanceOptions) => {\r\n            var instance = new FilterableCollectionManager(this.$q,this.$timeout);\r\n            instance.items = options.items;\r\n            instance.numberOfItems = options.items.length;\r\n            instance.filterFn = options.scope[\"vm\"][options.filterFnNameOnVm];\r\n\r\n            options.scope.$watch(options.searchTermNameOnScope, (searchTerm:any) => {\r\n                instance.searchTerm = searchTerm;\r\n                for (var i = 0; i < instance.subscriptions.length; i++) {\r\n                    instance.subscriptions[i].callback();\r\n                }\r\n            });\r\n            return instance;\r\n        }\r\n\r\n        public getIndexByCriteriaAsync = (options: any) => {\r\n\r\n            var deferred = this.$q.defer();\r\n\r\n            var index = null;\r\n\r\n            for (var i = 0; i < this.items.length; i++) {\r\n                if (this.items[i][options.criteria.key] == options.criteria.value) {\r\n                    index = i;\r\n                }\r\n            }\r\n\r\n            deferred.resolve({ index: index });\r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public searchTerm: string;\r\n\r\n        public filterFn: any;\r\n\r\n        private _numberOfItems: number;\r\n\r\n        public get numberOfItems() {\r\n            return this._numberOfItems;\r\n        }\r\n\r\n        public set numberOfItems(value: number) {\r\n            this._numberOfItems = value;\r\n        }\r\n\r\n        private _items: any[];\r\n\r\n        public get items() {\r\n            if (this.searchTerm && this.searchTerm != \"\") {\r\n                return this._items.filter((item: any) => {\r\n                    return this.filterFn(item, this.searchTerm);\r\n                });\r\n            }\r\n            return this._items;\r\n        }\r\n\r\n        public set items(value: any[]) {\r\n            this._items = value;\r\n        }\r\n\r\n        public subscriptions: ISubscription[] = [];\r\n\r\n        public subscribe = (options: ISubscribeOptions) => {\r\n            this.subscriptions.push({\r\n                callback: options.callback,\r\n                id: this.subscriptions.length + 1,\r\n                isActive: true\r\n            });\r\n            return this.subscriptions.length;\r\n        }\r\n    }\r\n    //class FilterableCollectionManager implements IFilterableCollectionManager {\r\n    //    constructor(private $q:ng.IQService, private $timeout:ng.ITimeoutService,private observeOnScope: any) { }\r\n\r\n    //    public createInstance = (options: IFilterableCollectionManagerInstanceOptions) => {\r\n    //        var instance = new FilterableCollectionManager(this.$q,this.$timeout, this.observeOnScope);\r\n    //        instance.items = options.items;\r\n    //        instance.numberOfItems = options.items.length;\r\n\r\n    //        var timeoutPromise = null;\r\n\r\n    //        instance.observeOnScope(options.scope, options.searchTermNameOnScope)\r\n    //            .map(function (data) {\r\n    //                return data;\r\n    //            })\r\n    //            .subscribe(function (change) {\r\n\r\n    //            if (change.oldValue != change.newValue) {\r\n\r\n    //                if (timeoutPromise)\r\n    //                    instance.$timeout.cancel(timeoutPromise);\r\n\r\n    //                timeoutPromise = instance.$timeout(() => {\r\n    //                    for (var i = 0; i < instance.subscriptions.length; i++) {\r\n    //                        instance.subscriptions[i].callback();\r\n    //                    }\r\n    //                }, 10, false);\r\n    //            }\r\n    //        });\r\n    //        return instance;\r\n    //    }\r\n\r\n    //    public getIndexByCriteriaAsync = (options: any) => {\r\n\r\n    //        var deferred = this.$q.defer();\r\n\r\n    //        deferred.resolve(true);\r\n\r\n    //        return deferred.promise;\r\n    //    } \r\n\r\n    //    public scope: any;\r\n\r\n    //    private _numberOfItems: number;\r\n\r\n    //    public get numberOfItems() {\r\n    //        return this._numberOfItems;\r\n    //    }\r\n\r\n    //    public set numberOfItems(value: number) {\r\n    //        this._numberOfItems = value;\r\n    //    }\r\n\r\n    //    private _items: any[];\r\n\r\n    //    public get items() {\r\n    //        return this._items;\r\n    //    }\r\n\r\n    //    public set items(value: any[]) {\r\n    //        this._items = value;\r\n    //    }\r\n\r\n    //    public subscriptions: ISubscription[] = [];\r\n\r\n    //    public subscribe = (options: ISubscribeOptions) => {\r\n    //        this.subscriptions.push({\r\n    //            callback: options.callback,\r\n    //            id: this.subscriptions.length + 1,\r\n    //            isActive: true\r\n    //        });\r\n    //        return this.subscriptions.length;\r\n    //    }\r\n    //}\r\n\r\n    angular.module(\"virtualIndexedListView\").service(\"virtualIndexedListView.filterableCollectionManager\", [\"$q\", \"$timeout\",FilterableCollectionManager]);\r\n} "],"sourceRoot":"/source/"}