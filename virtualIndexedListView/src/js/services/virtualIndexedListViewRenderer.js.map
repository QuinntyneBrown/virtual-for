{"version":3,"sources":["services/virtualIndexedListViewRenderer.ts"],"names":["VirtualIndexedListView","VirtualIndexedListView.VirtualIndexedListViewRenderer","VirtualIndexedListView.VirtualIndexedListViewRenderer.constructor","VirtualIndexedListView.VirtualIndexedListViewRenderer.numberOfRenderedItems"],"mappings":"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","file":"services/virtualIndexedListViewRenderer.js","sourcesContent":["/// <reference path=\"../../typings/typescriptapp.d.ts\" />\r\n\r\nmodule VirtualIndexedListView {\r\n\r\n    \"use strict\";\r\n    \r\n    class VirtualIndexedListViewRenderer implements IVirtualIndexedListViewRenderer {\r\n        constructor(private $compile: ng.ICompileService, private $injector: ng.auto.IInjectorService, private $interval: ng.IIntervalService) {\r\n\r\n        }\r\n\r\n        public createInstance = (options: any) => {\r\n            var instance = new VirtualIndexedListViewRenderer(this.$compile, this.$injector, this.$interval);\r\n            instance.containerHeight = options.containerHeight;\r\n            instance.items = options.items;\r\n            instance.itemName = options.itemName;\r\n            instance.scope = options.scope;\r\n            instance.element = options.element;\r\n            instance.template = options.template;\r\n            instance.itemHeight = options.itemHeight;\r\n            instance.viewPort = (<IViewPort>this.$injector.get(\"virtualIndexedListView.viewPort\")).createInstance({ element: this.element });\r\n\r\n            setInterval(() => {\r\n                if (instance.lastYScroll != instance.viewPort.scrollY) {\r\n                    instance.render({ scrollY: instance.viewPort.scrollY, lastScrollY: instance.lastYScroll, viewPortHeight: instance.viewPort.height });\r\n                }\r\n                instance.lastYScroll = instance.viewPort.scrollY;\r\n            }, 200);\r\n\r\n            return instance;\r\n        }\r\n\r\n        public render = (options: IRenderOptions) => {\r\n\r\n            if (this.hasRendered === false) {\r\n                var containerElement = angular.element(\"<div class='container'></div>\");\r\n                containerElement.css(\"height\", this.containerHeight);\r\n\r\n                this.element.append(containerElement);\r\n\r\n                for (var i = 0; i < this.numberOfRenderedItems; i++) {\r\n                    var childScope = this.scope.$new(true);\r\n                    childScope[this.itemName] = this.items[i];\r\n                    var itemContent = this.$compile(angular.element(this.template))(childScope);\r\n                    containerElement.append(itemContent);\r\n                }\r\n            }\r\n\r\n            if (this.getScrollDirections(options.scrollY, options.lastScrollY) === ScrollingDirection.Down) {\r\n                // get all the completlly invisible items between 0 and scrollY \r\n                // order by the top asc,\r\n                // translate each to bottom\r\n            }\r\n\r\n            if (this.getScrollDirections(options.scrollY, options.lastScrollY) === ScrollingDirection.Up) {\r\n                // get all the completlly invisible items between viewPortBottom containerBottom and scrollY \r\n                // order by the top asc,\r\n                // translate each to bottom\r\n            }\r\n\r\n            this.hasRendered = true;\r\n        }\r\n\r\n        public getScrollDirections = (scrollY:number, lastScrollY:number): ScrollingDirection => {\r\n            if (lastScrollY && scrollY > lastScrollY) {\r\n                return ScrollingDirection.Down;\r\n            }\r\n\r\n            if (lastScrollY && scrollY < lastScrollY) {\r\n                return ScrollingDirection.Up;\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        private viewPort: IViewPort;\r\n\r\n        public hasRendered: boolean = false;\r\n\r\n        public element: ng.IAugmentedJQuery;\r\n\r\n        public template: string;\r\n\r\n        public containerHeight: number;\r\n\r\n        public items: any[];\r\n\r\n        public itemName: string;\r\n\r\n        public scope: ng.IScope;\r\n\r\n        public itemHeight: number;\r\n\r\n        public lastYScroll: number = 0;\r\n\r\n        public get numberOfRenderedItems() {\r\n\r\n            var maximumScreenSize:number = 1380;\r\n\r\n            return Math.ceil(maximumScreenSize / this.itemHeight);\r\n        }\r\n    }\r\n\r\n    angular.module(\"virtualIndexedListView\").service(\"virtualIndexedListViewRenderer\", [\"$compile\", \"$injector\",\"$interval\", VirtualIndexedListViewRenderer]);\r\n} "],"sourceRoot":"/source/"}