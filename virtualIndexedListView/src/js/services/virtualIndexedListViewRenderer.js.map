{"version":3,"sources":["services/virtualIndexedListViewRenderer.ts"],"names":["VirtualIndexedListView","VirtualIndexedListView.VirtualIndexedListViewRenderer","VirtualIndexedListView.VirtualIndexedListViewRenderer.constructor","VirtualIndexedListView.VirtualIndexedListViewRenderer.scrollEventName","VirtualIndexedListView.VirtualIndexedListViewRenderer.numberOfRenderedItems"],"mappings":"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","file":"services/virtualIndexedListViewRenderer.js","sourcesContent":["/// <reference path=\"../../typings/typescriptapp.d.ts\" />\r\n\r\nmodule VirtualIndexedListView {\r\n\r\n    \"use strict\";\r\n    \r\n    class VirtualIndexedListViewRenderer implements IVirtualIndexedListViewRenderer {\r\n        constructor(private $compile: ng.ICompileService,\r\n            private $interval: ng.IIntervalService,\r\n            private getScrollDirection:any,\r\n            private getY: IGetY,\r\n            private injector: IInjector,\r\n            private transformY: ITransformY) {\r\n\r\n        }\r\n\r\n        public createInstance = (options: any) => {\r\n            var instance = new VirtualIndexedListViewRenderer(this.$compile, this.$interval, this.getScrollDirection, this.getY, this.injector, this.transformY);\r\n            instance.itemName = options.itemName;\r\n            instance.scope = options.scope;\r\n            instance.element = options.element;\r\n            instance.template = options.template;\r\n            instance.itemHeight = Number(options.itemHeight);\r\n            instance.name = options.name;\r\n\r\n            instance.viewPort = this.injector.get({ interface: \"IViewPort\", element: instance.element });\r\n            instance.container = this.injector.get({ interface: \"IContainer\", element: instance.element });\r\n            instance.collectionManager = this.injector.get({ interface: \"ICollectionManager\", element: instance.element, scope: options.scope, searchTermNameOnScope: options.searchTermNameOnScope, filterFnNameOnVm: options.filterFnNameOnVm, items: options.items, dataService: options.dataService });\r\n            instance.renderedNodes = this.injector.get({ interface: \"IRenderedNodes\", container: instance.container });\r\n\r\n            if (instance.collectionManager.type == collectionType.lazyLoad) {\r\n                instance.$interval(() => {\r\n                    (<ILazyLoadCollectionManager>instance.collectionManager).loadMore();\r\n                }, 1000, null, false);\r\n            }\r\n\r\n            instance.scope.$on(instance.scrollEventName, (event:any, criteria:any) => {\r\n                instance.collectionManager.getIndexByCriteriaAsync({ criteria: criteria }).then((result: any) => {\r\n                    instance.viewPort.scrollTo(result.index * instance.itemHeight);\r\n                });\r\n            });\r\n\r\n            instance.collectionManager.subscribe({\r\n                callback: () => {\r\n                    instance.forceRender({\r\n                        viewPortHeight: instance.viewPort.height\r\n                    });\r\n                }\r\n            });\r\n\r\n            instance.container.setHeight(instance.collectionManager.numberOfItems * instance.itemHeight);\r\n\r\n            instance.$interval(() => {\r\n                instance.render({\r\n                    scrollY: instance.viewPort.scrollY,\r\n                    lastScrollY: instance.lastYScroll,\r\n                    viewPortHeight: instance.viewPort.height\r\n                });\r\n                instance.lastYScroll = instance.viewPort.scrollY;\r\n            }, 10,null, false);\r\n\r\n            return instance;\r\n        }\r\n\r\n        public render = (options?: IRenderOptions) => {\r\n\r\n            if (!options) {\r\n                options = {\r\n                    lastScrollY:  0,\r\n                    scrollY: 0,\r\n                    viewPortHeight: this.viewPort.height\r\n                };\r\n            }\r\n\r\n            if (options.force ) {\r\n                this.forceRender(options);\r\n                return;\r\n            }\r\n\r\n            if (this.hasRendered === false) {\r\n                this.initialRender(options);\r\n            }\r\n\r\n            if (this.getScrollDirection(options.scrollY, options.lastScrollY) === ScrollingDirection.Down) {\r\n                this.renderDown(options);\r\n                return;\r\n            }\r\n\r\n            if (this.getScrollDirection(options.scrollY, options.lastScrollY) === ScrollingDirection.Up) {\r\n                this.renderUp(options);\r\n                return;\r\n            }\r\n\r\n            if (this.getScrollDirection(options.scrollY, options.lastScrollY) === ScrollingDirection.None) {\r\n                this.stabilizeRender(options);\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n        public forceRender = (options: IRenderOptions) => {\r\n\r\n            if (!this.hasRendered)\r\n                return;\r\n\r\n            this.container.reInitialize({ height: this.collectionManager.numberOfItems * this.itemHeight });\r\n            this.initialRender(options);\r\n\r\n            if (!this.scope.$$phase && !this.scope.$root.$$phase)\r\n                this.scope.$digest();     \r\n                 \r\n        }\r\n\r\n        public initialRender = (options: IRenderOptions) => {\r\n            for (var i = 0; i < this.numberOfRenderedItems; i++) {\r\n                var childScope: any = this.scope.$new(true);\r\n                childScope[this.itemName] = this.collectionManager.items[i];\r\n                childScope.$$index = i;\r\n                var itemContent = this.$compile(angular.element(this.template))(childScope);\r\n                this.container.augmentedJQuery.append(itemContent);\r\n            }\r\n            this.hasRendered = true;\r\n        }\r\n\r\n        public renderDown = (options: IRenderOptions) => {\r\n            var reachedBottom = false;\r\n            var allNodesHaveBeenMoved = false;\r\n\r\n            do {\r\n                var headAndTail = this.renderedNodes.getHeadAndTail();\r\n                var tail = headAndTail.tail;\r\n                var head = headAndTail.head;\r\n\r\n                if (tail.bottom >= this.container.bottom)\r\n                    reachedBottom = true;\r\n\r\n                if (head.bottom >= options.scrollY)\r\n                    allNodesHaveBeenMoved = true;\r\n\r\n                if (!reachedBottom && !allNodesHaveBeenMoved)\r\n                    this.moveAndUpdateScope({\r\n                        node: head.node,\r\n                        position: (this.numberOfRenderedItems * this.itemHeight) + this.getY(head.node),\r\n                        index: tail.index + 1,\r\n                        item: this.collectionManager.items[tail.index + 1]\r\n                    });\r\n\r\n            } while (!reachedBottom && !allNodesHaveBeenMoved)\r\n        }\r\n\r\n        public moveAndUpdateScope = (options:any) => {\r\n            this.transformY(options.node, options.position);\r\n            var scope: any = angular.element(options.node).scope();\r\n            scope[this.itemName] = options.item;\r\n            scope.$$index = options.index;\r\n            scope.$digest();\r\n        }\r\n\r\n        public renderUp = (options: IRenderOptions) => {\r\n            var reachedTop = false;\r\n            var allNodesHaveBeenMoved = false;\r\n\r\n            do {\r\n                var headAndTail = this.renderedNodes.getHeadAndTail();\r\n                var tail = headAndTail.tail;\r\n                var head = headAndTail.head;\r\n\r\n                if (tail.bottom <= this.container.htmlElement.offsetTop + (this.itemHeight * this.numberOfRenderedItems))\r\n                    reachedTop = true;\r\n\r\n                if (tail.top <= (this.viewPort.scrollY + this.viewPort.height))\r\n                    allNodesHaveBeenMoved = true;\r\n\r\n                if (!reachedTop && !allNodesHaveBeenMoved)\r\n                    this.moveAndUpdateScope({\r\n                        node: tail.node,\r\n                        position: this.getY(tail.node) - (this.numberOfRenderedItems * this.itemHeight),\r\n                        index: head.index - 1,\r\n                        item: this.collectionManager.items[head.index - 1]\r\n                    });\r\n\r\n            } while (!reachedTop && !allNodesHaveBeenMoved)       \r\n        }\r\n\r\n        public stabilizeRender = (options: IRenderOptions) => {\r\n            var headAndTail = this.renderedNodes.getHeadAndTail();\r\n            var top = headAndTail.head.top;\r\n            var bottom = headAndTail.tail.bottom;\r\n\r\n            if (top > options.scrollY) {\r\n                this.renderUp(options);\r\n            }\r\n\r\n            if (bottom <= options.scrollY + options.viewPortHeight) {\r\n                this.renderDown(options);\r\n            }\r\n        }\r\n\r\n        public hasRendered: boolean = false;\r\n\r\n        public element: ng.IAugmentedJQuery;\r\n\r\n        public template: string;\r\n\r\n        public itemName: string;\r\n\r\n        public name: string;\r\n\r\n        public get scrollEventName() {\r\n            return \"virtualIndexedListViewScroll\" + this.name;\r\n        }\r\n\r\n        public scope: any;\r\n\r\n        public itemHeight: number;\r\n\r\n        public lastYScroll: number = 0;\r\n\r\n        public get numberOfRenderedItems() {\r\n            var max = Math.ceil((this.viewPort.height + this.container.htmlElement.offsetTop) / Number(this.itemHeight));\r\n            if (this.collectionManager.numberOfItems < max)\r\n                return this.collectionManager.numberOfItems;\r\n            return max;\r\n        }\r\n\r\n        public collectionManager: ICollectionManager;\r\n\r\n        public container: IContainer;\r\n\r\n        private viewPort: IViewPort;\r\n\r\n        private renderedNodes: IRenderedNodes;\r\n    }\r\n\r\n    angular.module(\"virtualIndexedListView\").service(\"virtualIndexedListViewRenderer\", [\"$compile\",\r\n        \"$interval\",\r\n        \"virtualIndexedListView.getScrollDirection\",\r\n        \"virtualIndexedListView.getY\",\r\n        \"virtualIndexedListView.injector\",\r\n        \"virtualIndexedListView.transformY\", VirtualIndexedListViewRenderer]);\r\n} "],"sourceRoot":"/source/"}